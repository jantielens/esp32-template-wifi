<!DOCTYPE html>
<html lang="en">
{{HEADER}}
<body>
    <div class="container">
        {{NAV}}

        <form id="config-form">
            <!-- Hello World and Sample Settings (2-column on desktop) -->
            <div class="grid-2col">
            <!-- Hello World Section -->
            <section class="section">
                <h2>üëã Hello World</h2>
                <p style="font-size: 16px; line-height: 1.6; color: #1d1d1f; margin-bottom: 16px;">
                    Welcome to your ESP32 device! This is a simple demonstration section.
                </p>
                <p style="font-size: 14px; color: #86868b; margin: 0;">
                    üí° <strong>Tip:</strong> You can modify this welcome message in <code style="background: #f5f5f7; padding: 2px 6px; border-radius: 4px; font-size: 13px;">src/app/web/home.html</code>
                </p>
            </section>

            <!-- Sample Settings Section -->
            <section class="section">
                <h2>‚öôÔ∏è Sample Settings</h2>
                <div class="form-group">
                    <label for="dummy_setting">Dummy Setting</label>
                    <input type="text" id="dummy_setting" name="dummy_setting" maxlength="63">
                    <small>Example setting for demonstration</small>
                </div>
            </section>
            </div>

            <!-- Operating Mode & Cadence -->
            <section class="section" id="power-settings-section">
                <h2>‚ö° Operating Mode & Cadence</h2>
                <small>Controls how the device runs and how often it publishes.</small>

                <div class="grid-2col">
                    <section class="section" style="padding: 0; background: transparent; box-shadow: none;">
                        <div class="form-group">
                            <label for="power_mode">Operating Mode</label>
                            <select id="power_mode" name="power_mode">
                                <option value="always_on">Always-On</option>
                                <option value="duty_cycle">Duty-Cycle</option>
                            </select>
                            <small>Always-On keeps services running. Duty-Cycle wakes, publishes, then sleeps.</small>
                        </div>
                    </section>

                    <section class="section" style="padding: 0; background: transparent; box-shadow: none;">
                        <div class="form-group">
                            <label for="publish_transport">Transport Mode</label>
                            <select id="publish_transport" name="publish_transport">
                                <option value="ble">BLE</option>
                                <option value="mqtt">MQTT</option>
                                <option value="ble_mqtt">BLE + MQTT</option>
                            </select>
                            <small>Select which transports publish telemetry.</small>
                        </div>
                    </section>
                </div>

                <div class="grid-2col">
                    <section class="section" style="padding: 0; background: transparent; box-shadow: none;">
                        <div class="form-group">
                            <label for="cycle_interval_seconds">Cycle Interval (seconds)</label>
                            <input type="number" id="cycle_interval_seconds" name="cycle_interval_seconds" min="1" max="65535" placeholder="120">
                            <small>Duty-Cycle sleep interval and BLE/MQTT publish cadence.</small>
                        </div>
                    </section>

                    <section class="section" style="padding: 0; background: transparent; box-shadow: none;">
                        <div class="form-group">
                            <label for="portal_idle_timeout_seconds">Portal Idle Timeout (seconds)</label>
                            <input type="number" id="portal_idle_timeout_seconds" name="portal_idle_timeout_seconds" min="0" max="65535" placeholder="120">
                            <small>Auto-sleep after inactivity in Config/AP modes only.</small>
                        </div>
                    </section>
                </div>

                <div class="form-group">
                    <label for="wifi_backoff_max_seconds">WiFi Backoff Max (seconds)</label>
                    <input type="number" id="wifi_backoff_max_seconds" name="wifi_backoff_max_seconds" min="1" max="65535" placeholder="900">
                    <small>Exponential backoff cap on repeated Wi-Fi failures.</small>
                </div>

                <section class="section" id="mqtt-transport-section" style="margin-top: 12px;">
                    <h3 style="margin: 0 0 12px 0; font-size: 16px; color: #1d1d1f;">MQTT Transport</h3>

                    <div class="form-group">
                        <label for="mqtt_publish_scope">MQTT Payload Scope</label>
                        <select id="mqtt_publish_scope" name="mqtt_publish_scope">
                            <option value="sensors_only">Sensors only</option>
                            <option value="diagnostics_only">Diagnostics only</option>
                            <option value="all">All (sensors + diagnostics)</option>
                        </select>
                        <small>Controls which fields are included in the MQTT state payload.</small>
                    </div>

                    <small>MQTT publish cadence follows the Cycle Interval.</small>
                </section>

                <section class="section" id="ble-settings-section" style="margin-top: 12px;">
                    <h3 style="margin: 0 0 12px 0; font-size: 16px; color: #1d1d1f;">BLE Transport</h3>

                    <div class="grid-2col">
                        <section class="section" style="padding: 0; background: transparent; box-shadow: none;">
                            <div class="form-group">
                                <label for="ble_adv_burst_ms">Burst Duration (ms)</label>
                                <input type="number" id="ble_adv_burst_ms" name="ble_adv_burst_ms" min="100" max="60000" placeholder="900">
                            </div>
                        </section>
                        <section class="section" style="padding: 0; background: transparent; box-shadow: none;">
                            <div class="form-group">
                                <label for="ble_adv_gap_ms">Gap Duration (ms)</label>
                                <input type="number" id="ble_adv_gap_ms" name="ble_adv_gap_ms" min="100" max="60000" placeholder="1100">
                            </div>
                        </section>
                    </div>

                    <div class="grid-2col">
                        <section class="section" style="padding: 0; background: transparent; box-shadow: none;">
                            <div class="form-group">
                                <label for="ble_adv_bursts">Bursts</label>
                                <input type="number" id="ble_adv_bursts" name="ble_adv_bursts" min="1" max="10" placeholder="2">
                            </div>
                        </section>
                        <section class="section" style="padding: 0; background: transparent; box-shadow: none;">
                            <div class="form-group">
                                <label for="ble_adv_interval_ms">Adv Interval (ms)</label>
                                <input type="number" id="ble_adv_interval_ms" name="ble_adv_interval_ms" min="20" max="10000" placeholder="100">
                            </div>
                        </section>
                    </div>

                    <small>Applies when BLE transport is enabled.</small>
                </section>
            </section>

            <!-- Sensors Section (hidden if no sensor data) -->
            <section class="section" id="sensors-section" style="display:none;">
                <h2>üß™ Sensor data</h2>
                <div id="sensor-badges" class="sensor-badges"></div>
                <small style="display:block; margin-top: 8px; color:#86868b;">Live values from /api/health</small>
            </section>

            <!-- Display Settings Section (hidden if no backlight support) -->
            <section class="section" id="display-settings-section" style="display:none;">
                <h2>üñ•Ô∏è Display Settings</h2>
                <div class="form-group">
                    <label for="backlight_brightness">
                        Backlight Brightness: <span id="brightness-value">100</span>%
                    </label>
                    <input type="range" id="backlight_brightness" name="backlight_brightness" 
                           min="0" max="100" value="100" 
                           style="width: 100%; height: 8px; border-radius: 4px; background: linear-gradient(to right, #007aff 0%, #007aff 100%, #e5e5e5 100%, #e5e5e5 100%);">
                    <small>Brightness adjusts immediately. Click Save to persist across reboots.</small>
                </div>

                <hr style="border: none; border-top: 1px solid #e5e5ea; margin: 18px 0;">

                <h3 style="margin: 0 0 12px 0; font-size: 16px; color: #1d1d1f;">Screen Saver (Burn-in Prevention)</h3>

                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="screen_saver_enabled" name="screen_saver_enabled">
                        Enable screen saver (turn off backlight when idle)
                    </label>
                    <small>When enabled, the backlight will fade out after inactivity.</small>
                </div>

                <div class="form-group">
                    <label for="screen_saver_timeout_seconds">Idle Timeout (seconds)</label>
                    <input type="number" id="screen_saver_timeout_seconds" name="screen_saver_timeout_seconds" min="0" max="65535" placeholder="300">
                    <small>0 disables automatic sleep. Example: 300 = 5 minutes.</small>
                </div>

                <div class="grid-2col">
                    <section class="section" style="padding: 0; background: transparent; box-shadow: none;">
                        <div class="form-group">
                            <label for="screen_saver_fade_out_ms">Fade Out (ms)</label>
                            <input type="number" id="screen_saver_fade_out_ms" name="screen_saver_fade_out_ms" min="0" max="60000" placeholder="800">
                            <small>0 = instant off</small>
                        </div>
                    </section>
                    <section class="section" style="padding: 0; background: transparent; box-shadow: none;">
                        <div class="form-group">
                            <label for="screen_saver_fade_in_ms">Fade In (ms)</label>
                            <input type="number" id="screen_saver_fade_in_ms" name="screen_saver_fade_in_ms" min="0" max="60000" placeholder="400">
                            <small>0 = instant on</small>
                        </div>
                    </section>
                </div>

                <div class="form-group">
                    <label style="display: flex; align-items: center; gap: 10px;">
                        <input type="checkbox" id="screen_saver_wake_on_touch" name="screen_saver_wake_on_touch">
                        Wake on touch press
                    </label>
                    <small>Only applies to touch-enabled boards.</small>
                </div>

                <div class="form-group" id="screen-selection-group" style="display:none;">
                    <label for="screen_selection">
                        Current Screen
                    </label>
                    <select id="screen_selection" name="screen_selection">
                        <!-- Options populated by JavaScript from /api/info -->
                    </select>
                    <small>Switch between screens instantly. Selection is not saved (resets on reboot).</small>
                </div>
            </section>

            {{FOOTER}}
        </form>
    </div>

    <script src="/portal.js"></script>
</body>
</html>
